{% set cols = 5 %}
{% if problems|length > 25 %}
    {% set cols = 6 %}
{% endif %}
{% if problems|length > 30 %}
    {% set cols = 7 %}
{% endif %}
{% if problems|length > 35 %}
    {% set cols = 8 %}
{% endif %}

<style>
.problem-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 4rem 6rem;  /* More vertical and horizontal spacing */
    padding: 2rem;
    margin: 0 auto;
    max-width: 8.5in;
}

.problem {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: 24pt;  /* Larger font size */
    line-height: 1.4;
    padding: 0.5rem;
}

.addition-line {
    border-bottom: 1.5px solid black;  /* Slightly thicker line */
    width: 100%;
    margin: 0.25rem 0;
}

.answer-space {
    height: 2rem;  /* Taller answer space */
    width: 100%;
    min-width: 5rem;  /* Ensure minimum width */
}

.number {
    text-align: right;
    width: 100%;
    min-width: 5rem;  /* Ensure minimum width for numbers */
    font-family: 'Times New Roman', serif;
    padding: 0.1rem 0;  /* Consistent vertical spacing */
}

.operator {
    position: absolute;
    left: -1.25rem;  /* More space for operator */
    top: 50%;  /* Center vertically with second number */
    transform: translateY(-50%);
}

.problem-content {
    position: relative;
    width: 5rem;  /* Wider content area */
}

/* Division problem specific styles */
.division-problem {
    display: flex;
    align-items: center;
}

.division-symbol {
    display: flex;
    align-items: center;
}

.division-symbol .divisor {
    margin-right: 0.25rem;
}

.division-symbol .right-paren {
    font-size: 1.5em;
    line-height: 1;
}

.division-symbol .dividend {
    margin-left: 0.25rem;
}

@media print {
    @page {
        margin: 0.4in;
        /* Remove browser-added headers and footers */
        margin-header: 0;
        margin-footer: 0;
    }
    
    /* Ensure colors print correctly */
    * {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    /* Hide URL, title, and page numbers */
    html {
        height: 100%;
    }
    body {
        height: 100%;
        position: relative;
    }
}

@media screen {
    .answer-space {
        background-color: #f0f4ff;  /* Lighter blue background */
    }
}
</style>

<script>
    // Remove dynamic adjustments to keep consistent sizing
    const root = document.documentElement;
</script>

<div class="problem-grid">
    {% for problem in problems %}
    <div class="problem">
        <div class="problem-content">
            {% set parts = problem.text.replace(' ', '').replace('×', '*').replace('÷', '/') %}
            {% if '+' in parts %}
                {% set numbers = parts.split('+') %}
                <div class="number">{{ numbers[0] }}</div>
                <div class="number"><span class="operator">+</span>{{ numbers[1] }}</div>
                <div class="addition-line"></div>
                <div class="answer-space"></div>
            {% elif '-' in parts %}
                {% set numbers = parts.split('-') %}
                <div class="number">{{ numbers[0] }}</div>
                <div class="number"><span class="operator">−</span>{{ numbers[1] }}</div>
                <div class="addition-line"></div>
                <div class="answer-space"></div>
            {% elif '*' in parts %}
                {% set numbers = parts.split('*') %}
                <div class="number">{{ numbers[0] }}</div>
                <div class="number"><span class="operator">×</span>{{ numbers[1] }}</div>
                <div class="addition-line"></div>
                <div class="answer-space"></div>
            {% elif '/' in parts %}
                {% set numbers = parts.split('/') %}
                <div class="division-problem">
                    <div class="division-symbol">
                        <span class="divisor">{{ numbers[1] }}</span>
                        <span class="right-paren">)</span>
                        <span class="dividend">{{ numbers[0] }}</span>
                    </div>
                </div>
                <div class="answer-space"></div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div> 